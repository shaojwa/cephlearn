## 关于多态使用
基类  LogEvent 中定义很多虚函数，比如 encode，decode，dump。
```
class EOpen : public LogEvent
```
在使用EOpen的接口中，比如start_entry（），submit_entry（） 都是用的基类参数：

```
void start_entry(LogEvent *e) {}
void submit_entry(LogEvent *e, MDSLogContextBase *c = 0) 
```

## 多态函数的定义

多态函数参数一定是基类类型，派生类override虚函数的时候，派生类中的接口参数也还是基类的参数。

```
virtual void set_object_info(MDSCacheObjectInfo &info) { ceph_abort(); }
```

## 多态函数中无法操作派生类中的成员

因为传入的是基类的指针，虚函数是通用接口，操作积累中共有的元素。派生类中特有的成员应该用派生类中的接口单独处理。


## 派生类中override的虚函数也无法访问基类中的private成员

应该只能由基类的虚函数来访问。

## 工作函数中不获取锁，接口函数中获取锁
```
Journaler::wait_for_flush() -> _wait_for_flush()
Journaler::flush() -> _flush()
```

## 获取一个值和获取多个值的写法区别

获取一个值：
```
inodeno_t InoTable::project_alloc_id(inodeno_t id) 
```
获取多个值：
```
void InoTable::project_alloc_ids(interval_set<inodeno_t>& ids, int want) 
```

## CDir中的为什么两个get_inode()函数
```
CInode *get_inode()   { return inode; }
const CInode *get_inode() const { return inode; }
``` 
diri = dir->get_inode() 调用时会根据dir是不是const指针进行选择，如果dir是const指正，那么编译时只会调用第二个接口。 所以，而如果CInode中获取字段的接口如果没有const属性，就不能调用，所以代码中很多时候以diri->inode的方式直接访问字段。

## 根据字段类型返回字段名接口参考
```
static inline const char *get_lock_action_name(int a)
```
# 进程线程管理
## 自杀线程
```
pthread_kill(h->thread_id, SIGABRT);
```

# 输入输出
## 输入输出基本概念

这里的输入输出流，都是针对程序本身。程序打算输出到外面的，不管是输出到文件还是显示器。
而输入就是要读入到程序中的，从外部文件或者标准输入读取。
所以对程序来说，针对输出流一般进行写操作，针对输入流一般进行读操作。

## stringstream ss(" mds_load is ")之后通过operator<<之后为什么没有输出

其实是原有的数据被operator<<操作覆盖掉。stringstream继承iostream，所有的ostream都有一个位置属性。
有对应的接口tellp()可以查看位置。在ss初始化之后，write的位置并没有改变，所以<<操作会覆盖原有数据。
当<<之后再去看这个值就发现已经改变，所以<<是在追加。如果要让初始化的数据不会被覆盖，那么需要通过seekp来设置位置。
对应的，对于输入流，有tellg()和seekg()接口。

## stringstream 字符串流中的clear() 接口并不会清空原有数据
ss.clear() 不会清空流内容，只会设置错误标记，如果要清空内容，请用ss.str("")


# 语法相关
## Option.set_default("").set_description（""）写法
```
Option类有set_default()和set_description（）接口，返回的是对象自己的应用，即*this
```

# ceph 中的辅助函数
## ceph中有strict_strtol系列函数将string转为整数
``` 
int level = (int) strict_strtol(levelstr.c_str(), 10, &err);
```

## ceph中有get_str_vec接口来处理将string分割为vector
```
vector<string> kvs;
get_str_vec(config, ",",  kvs);
```

## 英文表述
```
HEALTH_WARN
HEALTH_ERR
```
