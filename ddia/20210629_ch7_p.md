## 防止更新丢失

因为隔离性，多个事务的写操作就可能会触发写入的数据的丢失（因为覆盖），这是一个严重的问题。怎么解决？
很容易想到的一个事情是，一个事务的进行需要获取到这个对象的锁，这就导致所有的写入的串行化，这会导致低性能。

这是数据库内置支持原子写入操作，如果数据库不支持，那就需要应用程序自己来做到原子操作，但是这容易引入问题。

## 关于并发写的问题，脏写不算并发写问题。

多个事务对同一个对象的并发写入，会有问题，很明显的一个问题是，事务A写入的数据，有一部分被事务B所覆盖。
因为事务A和B所基于的相同的数据采用不同的逻辑，最终事务完成之后，事务A和B同时写入就会有这个问题。

刚才的问题，并没有写脏数据，因为事务A和事务B，在判断时基于的是commit之后的数据，在写入时也是等前一个commit之后在写入，看起来流程是正常的，但是结果数据有问题。


另外一个问题是，如果A写入的数据并没有提交，这时候被B写入的数据覆盖，这时候B的操作就是脏写，意思是，在脏数据上写入。
其实，在我看来，这个不应该算是并发写的问题，而是事务的隔离性没做好。事务是隔离的，事务B不应该看到事务A在没有commit之前的数据，这是事务基本的ACID没做好。

