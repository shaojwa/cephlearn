## mds

## mon

查看mon状态
```
ceph mon dump
ceph mon_status
ceph quorum_status
```

主mon
```
ceph mon stat // 输出中有leader相关信息
```
## mgr

#### mgr 的作用
从L版本开始(12.x),这是一个要求的组件。mon维护各种map信息，而mgr维护除此之外的监控和管理。
  
#### mgr 提供的信息

  * pool的数目，pg数目
  * object的数目，存储的bytes
  * 存储使用率，性能指标，负载
  * pg健康状况
  
#### 缺少mgr

ceph -s 会有告警。data部分也会缺少部分信息，ceph health 会无法输出。

## osd

## rados

查看某个目录的所有对象：
```
[root@node11 dirfrag]# rados -p .capfs.metadata.Metadata ls | grep 10000000003
```

目录对象的omap是空：
```
[root@node11 data]# rados -p .capfs.metadata.Metadata listomapkeys 10000000003.00000000
[root@node11 data]#
```

目录对象的xattr是：
```
[root@node11 data]# rados -p .capfs.metadata.Metadata listxattr 10000000003.00000000
layout
parent
```

分片对象的omap是：
```
[root@node11 data]# rados -p .capfs.metadata.Metadata listomapkeys 10000000003.03200000  | head -2
file10020_head
file10023_head
```

分片对象的xattr是：
```
[root@node11 data]# rados -p .capfs.metadata.Metadata listxattr 10000000003.03200000
[root@node11 data]#
```

查看目录分片系数和大小：
```
[root@node12 ~]# ceph daemon mds.mds1 config show | grep split_bits
    "mds_bal_split_bits": "3",
[root@node12 ~]# ceph daemon mds.mds1 config show | grep split_size
    "mds_bal_split_size": "10000",
[root@node12 ~]#
```
