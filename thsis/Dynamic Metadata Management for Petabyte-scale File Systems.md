# 摘要

* 将读写操作从元数据操作中解耦对PB规模的分布式文件系统来说至关重要。
* 动态子树分区以及自适应元数据管理系统来高效的管理分层的元数据负载。

# 1 介绍

* 尽管元数据大小占整个文件系统大小的比例很低但是元数据的操作数量却占到50%左右。
* 相比OSD容量可以通过增加OSD来进行扩展，MDS因为相互之间更高的依赖性而使得设计更加具有挑战性。
* MDS集群需要在各种负载场景下，都能高效的管理文件系统目录以及权限，不管是科学计算还是通用计算。

### 文件系统负载

* 需要支持文件大小范围从几字节到TB字节，目录包含百万级文件，数千个客户端同时访问不同或者相同的文件。
* 工作负载也可能随时改变，MDS集群，要能通过动态得拆分负载，来持续适应当前的需求，以保持高性能以及长期可扩展性。
* 我们已用一种动态子树分区策略来持续调整元数据分布。
* 通过模拟基本的系统性能，对文件系统以及负载的调整，来评估元数据管理策略。

# 2 背景

* 考察的场景包括几十个MDS，几千个OSD，以及成百上千个client。
* 负载场景包括科学计算，网络归档，大数据中心等几个典型的分布式文件系统应用场景。

### 2.1 系统架构

* 一个主要的设计特点是将元数据管理从数据管理中分离出来。
* 把元数据操作（这种依更加复杂且相互依赖的语义操作）从数据操作中分离出来，可以避免常规文件服务器的IO瓶颈。
*　元数据服务器的主要工作：文件系统命名空间，目录层次，文件以及目录权限管理，文件到对象的映射。

### 2.1.1 数据分布

* 确定的伪随机算法
* 一个重要的文件数据分布算法是，OSD的序列可以被客户端重新计算出来，而不需要和MDS交互。

### 2.1.2  元数据分区

* 元数据负载必须能高效得在元数据服务器之间分布，以应付极端的负载：山该案个客户端打开同一个文件，或者写入同一个目录。
*　不同MDS之间的元数据缓存重叠要尽可能的小。
* MDS集群需要提供故障恢复机制。
* MDS集群扩展的时候能尽可能少的进行负载重新分布。

### 2.1.3 存储

* 需要一个共享的TB级别的持久化存储。

## 2.2 负载

* 元数据事务分两类：

  1. open,close,setattr等针对文件或者目录的inode。
  2. rename，unlink，等在影响系统命名空间以及层次的directory dentry。
 
 # 3 相关工作
 
 * 静态子树分区
  

